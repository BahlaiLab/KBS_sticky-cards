#add legend
legend(0.645,1.82, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.645,1.81, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.645,1.8, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.645,1.805, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.645,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.643,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.64,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.635,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.63,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.625,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.62,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
plot(NMDSold, disp='sites', type="n")
title(main="", adj = 0.01, line = -2, cex.main=2.5)
#add ellipsoids with ordiellipse
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#ffba21",kind="sd", conf=0.95, label=FALSE, show.groups = "Old20")
ordiellipse(NMDSold, env.matrix$CARDYEAR, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old20"),pch=15, col="#ffba21")
points(NMDSold, display="sites", select=which(env.matrix$CARDYEAR=="Old21"),pch=19, col="#E69F00")
#add legend
legend(0.622,1.806, title=NULL, pch=c(15,19), col=c("#ffba21", "#E69F00"), cex=1.2, legend=c("2020 Old cards", "2021 Old cards"))
#To obtain richness counts
insects.rowsums <- rowSums(new21_new22[,6:24]>0)
new21_new22$richness <- insects.rowsums
#To obtain abundance counts
insects.abun <- rowSums(new21_new22[,6:24])
new21_new22$abundance <- insects.abun
#calculate Shannon diversity
diversity <-diversity(new21_new22[,6:24])
new21_new22$diversity <-diversity
#calculate Evenness
evenness <-diversity/log(specnumber(new21_new22[,6:24]))
new21_new22$evenness <- evenness
#richness
#AIC 1936
richness.model<-glm(richness ~ CARDYEAR + week + TREAT + offset(TRAPS), data=new21_new22, family=poisson)
summary(richness.model)
Anova (richness.model)
#CARDYEAR: not sig , week and treatment: sig
AIC(richness.model)
#pairwise comparison
rich.emm<-emmeans(richness.model,pairwise~CARDYEAR)
rich.emm
#richness
#AIC 1234
richness.model<-glm(richness ~ CARDYEAR + week + TREAT + offset(TRAPS), data=new21_new22, family=poisson)
summary(richness.model)
Anova (richness.model)
#CARDYEAR: not sig , week and treatment: sig
AIC(richness.model)
#pairwise comparison
rich.emm<-emmeans(richness.model,pairwise~CARDYEAR)
rich.emm
#results: no sig diff btw cards (p=0.28)
rich.cld<-multcomp::cld(rich.emm, alpha = 0.05, Letters = LETTERS)
rich.cld
#abundance
##AIC 4253
abundance.model<-glm(abundance ~ CARDYEAR + week + TREAT + offset(TRAPS), data=new21_new22, family=poisson)
summary(abundance.model)
Anova(abundance.model)
#all sig (CARDYEAR, week, treatment)
AIC(abundance.model)
#pairwise comparison
abun.emm<-emmeans(abundance.model,pairwise~CARDYEAR)
abun.emm
#results: sig diff btw cards (p<0.0001)
abun.cld<-multcomp::cld(abun.emm, alpha = 0.05, Letters = LETTERS)
abun.cld
#diversity
##AIC 731
diversity.model<-glm(diversity ~ CARDYEAR + week + TREAT + offset(TRAPS), data=new21_new22)
summary(diversity.model)
Anova(diversity.model)
#all sig
AIC(diversity.model)
#pairwise comparison
div.emm<-emmeans(diversity.model,pairwise~CARDYEAR)
div.emm
#results: sig diff btw cards (p<0.0001)
div.cld<-multcomp::cld(div.emm, alpha = 0.05, Letters = LETTERS)
div.cld
#evenness
##AIC Inf
evenness.model<-glm(evenness ~ CARDYEAR + week + TREAT + offset(TRAPS), data=new21_new22, family = poisson)
summary(evenness.model)
Anova(evenness.model)
#CARDYEAR and week: not sig, treatment: sig
AIC(evenness.model)
#pairwise comparison
even.emm<-emmeans(evenness.model,pairwise~CARDYEAR)
even.emm
#results: no sig diff btw cards (0.13)
even.cld<-multcomp::cld(even.emm, alpha = 0.05, Letters = LETTERS)
even.cld
#CARDYEAR richness by card type
richness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = richness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
geom_text(data=rich.cld, aes(y = 12.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
richness.plot
#CARDYEAR richness by card type
richness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = richness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
#geom_text(data=rich.cld, aes(y = 12.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
richness.plot
#CARDYEAR richness by card type
richness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = richness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
geom_text(data=rich.cld, aes(y = 10, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
richness.plot
#CARDYEAR richness by card type
richness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = richness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
geom_text(data=rich.cld, aes(y = 11, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
richness.plot
#CARDYEAR richness by card type
richness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = richness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Richness")+
geom_text(data=rich.cld, aes(y = 10.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
richness.plot
#CARDYEAR abundance by card type
abundance.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = abundance, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
#geom_text(data=abun.cld, aes(y = 80, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
abundance.plot
#CARDYEAR abundance by card type
abundance.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = abundance, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
geom_text(data=abun.cld, aes(y = 100, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
abundance.plot
#CARDYEAR abundance by card type
abundance.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = abundance, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
geom_text(data=abun.cld, aes(y = 110, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
abundance.plot
#CARDYEAR abundance by card type
abundance.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = abundance, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
geom_text(data=abun.cld, aes(y = 120, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
abundance.plot
#CARDYEAR abundance by card type
abundance.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = abundance, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Abundance (log10)")+
scale_y_continuous(trans="log10")+
geom_text(data=abun.cld, aes(y = 130, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
abundance.plot
#CARDYEAR diveristy by card type
diversity.plot<-ggplot(old20_old21, aes(x = factor(CARDYEAR), y = diversity, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Shannon diversity")+
geom_text(data=div.cld, aes(y = 2.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
diversity.plot
#CARDYEAR diveristy by card type
diversity.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = diversity, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Shannon diversity")+
geom_text(data=div.cld, aes(y = 2.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
diversity.plot
#CARDYEAR diveristy by card type
diversity.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = diversity, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Shannon diversity")+
#geom_text(data=div.cld, aes(y = 2.5, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
diversity.plot
#CARDYEAR diveristy by card type
diversity.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = diversity, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Shannon diversity")+
geom_text(data=div.cld, aes(y = 2, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
diversity.plot
#CARDYEAR evenness by card type
evenness.plot<-ggplot(old20_old21, aes(x = factor(CARDYEAR), y = evenness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
#geom_text(data=even.cld, aes(y = 1.2, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
evenness.plot
#CARDYEAR evenness by card type
evenness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = evenness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
#geom_text(data=even.cld, aes(y = 1.2, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
evenness.plot
#CARDYEAR evenness by card type
evenness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = evenness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
geom_text(data=even.cld, aes(y = 1.2, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
evenness.plot
#CARDYEAR evenness by card type
evenness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = evenness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
geom_text(data=even.cld, aes(y = 1.1, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
evenness.plot
#CARDYEAR evenness by card type
evenness.plot<-ggplot(new21_new22, aes(x = factor(CARDYEAR), y = evenness, fill=CARDYEAR))+
geom_boxplot()+
theme_bw()+
theme(legend.position="bottom")+
labs(title="", x="", y="Evenness")+
geom_text(data=even.cld, aes(y = 1.2, label = .group))+
#theme (plot.title = element_text(hjust=0.5))+
scale_fill_manual(values=c("#ffba21","#E69F00","#009E73","#00c690"),name="Card:",
breaks=c("Old20", "Old21", "New21", "New22"),
labels=c("Old cards 2020", "Old cards 2021", "New cards 2021", "New cards 2022"))
evenness.plot
#
#mush together plots
library(ggpubr)
newcard_boxplot <- ggarrange(richness.plot, abundance.plot, diversity.plot, evenness.plot,
ncol = 2, nrow = 2,
common.legend = TRUE, legend = "bottom")
newcard_boxplot
pdf("newcard_boxplot.pdf", height=8, width=8) #height and width in inches
newcard_boxplot
dev.off()
pdf("combined NMDSs.pdf", height=6.5, width=13)
par(mfrow=c(1,3), mar=c(4.1, 4.8, 1.5, 8.1),xpd=TRUE)
plot(NMDS21, disp='sites', type="n")
title(main="A", adj = 0.01, line = -2, cex.main=2.5)
ordiellipse(NMDS21, env.matrix$CARD, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
pdf("combined NMDSs.pdf", height=6.5, width=20)
par(mfrow=c(1,3), mar=c(4.1, 4.8, 1.5, 8.1),xpd=TRUE)
plot(NMDS21, disp='sites', type="n")
title(main="A", adj = 0.01, line = -2, cex.main=2.5)
ordiellipse(NMDS21, env.matrix$CARD, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
pdf("combined NMDSs.pdf", height=10, width=13)
par(mfrow=c(1,3), mar=c(4.1, 4.8, 1.5, 8.1),xpd=TRUE)
plot(NMDS21, disp='sites', type="n")
title(main="A", adj = 0.01, line = -2, cex.main=2.5)
ordiellipse(NMDS21, env.matrix$CARD, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
pdf("combined NMDSs.pdf", height=10, width=13)
par(mfrow=c(3,1), mar=c(4.1, 4.8, 1.5, 8.1),xpd=TRUE)
plot(NMDS21, disp='sites', type="n")
title(main="A", adj = 0.01, line = -2, cex.main=2.5)
ordiellipse(NMDS21, env.matrix$CARD, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
pdf("combined NMDSs.pdf", height=10, width=13)
par(mfrow=c(3,3), mar=c(4.1, 4.8, 1.5, 8.1),xpd=TRUE)
plot(NMDS21, disp='sites', type="n")
title(main="A", adj = 0.01, line = -2, cex.main=2.5)
ordiellipse(NMDS21, env.matrix$CARD, draw="polygon", col="#E69F00",kind="sd", conf=0.95, label=FALSE, show.groups = "Old21")
#Create matrix of environmental variables
env.matrix<-insects21[c(1:4,30)]
#create matrix of community variables
com.matrix<-insects21[c(5:29)]
#bootstrapping and testing for differences between the groups (cards)
fit<-adonis2(com.matrix ~ CARD, data = env.matrix, permutations = 999, method="bray")
fit
#species accumulation for 2021
library (BiodiversityR)
library(ggplot2)
#individual curves for each trap (card) type
new.com.matrix<-new[c(8:32)]
#species accumulation for 2021
library (BiodiversityR)
library(ggplot2)
#individual curves for each trap (card) type
new.com.matrix<-new[c(8:32)]
new <- insects21[which(insects21$CARD=="New21"),]
old <- insects21[which(insects21$CARD=="Old21"),]
View(old)
#individual curves for each trap (card) type
new.com.matrix<-new[c(5:29)]
new_curve<-accumresult(new.com.matrix, method = "exact", permutations = 1000)
old.com.matrix<-old[c(5:29)]
old_curve<-accumresult(old.com.matrix, method = "exact", permutations = 1000)
#calculates species richness for each sample
specnumber(com.matrix) #ranges from 1 to 8?
#Create matrix of environmental variables
env.matrix<-insects21[c(1:4,30)]
#create matrix of community variables
com.matrix<-insects21[c(5:29)]
#calculates species richness for each sample
specnumber(com.matrix) #ranges from 1 to 8?
#calculates species richness by treatment (CARD)
specnumber(com.matrix, groups = insects21$CARD) #new=21; sticky=21
#total richness and jackknife
rich <- diversityresult(com.matrix, y=NULL, index = "richness")
rich # 21
#new jackknife; richness = 21
j1.new <- diversityresult(new.com.matrix, y=NULL, index = "jack1")
#species accumulation for 2021
library (BiodiversityR)
library(ggplot2)
#new jackknife; richness = 21
j1.new <- diversityresult(new.com.matrix, y=NULL, index = "jack1")
j1.new # 21.998366
#bring in data from all years
insects_all <- read.csv("https://raw.githubusercontent.com/BahlaiLab/KBS_sticky-cards/main/all%20years_LTER_for_analyses.csv", na.strings = NULL)
insects_all$week <- as.character(insects_all$week)
#change CARD, TREAT, and STATION to factor
insects_all$CARDYEAR <- as.factor(insects_all$CARDYEAR)
insects_all$CARD <- as.factor(insects_all$CARD)
insects_all$TREAT <- as.factor(insects_all$TREAT)
insects_all$STATION <- as.factor(insects_all$STATION)
str(insects_all)
summary(insects_all)
View(insects_all)
#calculate total abundance from all three years (of field collected data)
colSums(insects_all[,6:24])
#2020 abundance
old20 <- insects_all[which(insects_all$CARDYEAR=="Old20"),]
View(old20)
#2022 abundance
new22 <- insects_all[which(insects_all$CARDYEAR=="New22"),]
colSums(old20[,6:24])
colSums(new22[,6:24])
#diversity
##AIC 731
diversity.model<-glm(diversity ~ CARDYEAR + week + TREAT + offset(TRAPS), data=old20_old21)
